<!DOCTYPE html>
<!-- Generated by Cython 0.22 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p>Generated by Cython 0.22</p>
<p>Raw output: <a href="unsat_zone.c">unsat_zone.c</a></p>
<div class="cython"><pre class='cython line score-11' onclick='toggleDiv(this)'>+001: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython code score-11'>  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;002: <span class="sd">Created on Wed Apr 15 18:20:35 2015</span></pre>
<pre class='cython line score-0'>&#xA0;003: </pre>
<pre class='cython line score-0'>&#xA0;004: <span class="sd">This python script is used to solve the differential equations that are used for the unsaturated zone module. The output of the function is the soil state (how full it is) at each timestep, and the groundwater recharge R.</span></pre>
<pre class='cython line score-0'>&#xA0;005: </pre>
<pre class='cython line score-0'>&#xA0;006: <span class="sd">-------------------------------------Two models can be used:</span></pre>
<pre class='cython line score-0'>&#xA0;007: <span class="sd">- Piston Flow</span></pre>
<pre class='cython line score-0'>&#xA0;008: <span class="sd">dS/dt = (P-I) - K_sat * (S/S_cap)**Beta - E_p * min(1, S/0.5S_cap)</span></pre>
<pre class='cython line score-0'>&#xA0;009: </pre>
<pre class='cython line score-0'>&#xA0;010: <span class="sd">- Percolation</span></pre>
<pre class='cython line score-0'>&#xA0;011: <span class="sd">dS/ Dt = P[t+1] * (1 - (S[t] / S_cap)**Beta)- E_p * min(1, S/0.5S_cap)</span></pre>
<pre class='cython line score-0'>&#xA0;012: </pre>
<pre class='cython line score-0'>&#xA0;013: <span class="sd">-------------------------------------Numerical info:</span></pre>
<pre class='cython line score-0'>&#xA0;014: <span class="sd">The Soil module is is solved with an implicit euler and Newton Raphson iteration. The initial guesstimate for the the NR-iteration is provided by an Explicit Euler solution of the above differential equation. </span></pre>
<pre class='cython line score-0'>&#xA0;015: </pre>
<pre class='cython line score-0'>&#xA0;016: <span class="sd">-------------------------------------To Do:</span></pre>
<pre class='cython line score-0'>&#xA0;017: <span class="sd">    - Solve the Zero Division error by applying a bisection method</span></pre>
<pre class='cython line score-0'>&#xA0;018: <span class="sd">    - Solve when S[t+1] &gt; S_Cap or S[t+1] &lt; 0.00</span></pre>
<pre class='cython line score-0'>&#xA0;019: <span class="sd">    - Compile a C-file of this functin for quick calculation using Cython</span></pre>
<pre class='cython line score-0'>&#xA0;020: <span class="sd">    - Built in more external / internal checks for water balance</span></pre>
<pre class='cython line score-0'>&#xA0;021: </pre>
<pre class='cython line score-0'>&#xA0;022: <span class="sd">-------------------------------------References:     </span></pre>
<pre class='cython line score-0'>&#xA0;023: <span class="sd">- Kavetski, D., Kuczera, G. &amp; Franks, S.W. [2006]. Calibration of conceptuyal hydrological models revisited: 1. Overcoming numerical artefacts. Journal of Hydrology, 320, p. 173-186.  </span></pre>
<pre class='cython line score-0'>&#xA0;024: </pre>
<pre class='cython line score-0'>&#xA0;025: <span class="sd">@author: Raoul Collenteur</span></pre>
<pre class='cython line score-0'>&#xA0;026: </pre>
<pre class='cython line score-0'>&#xA0;027: <span class="sd"> -----------------------------------------------</span></pre>
<pre class='cython line score-0'>&#xA0;028: <span class="sd">In this section the percolation model is defined. </span></pre>
<pre class='cython line score-0'>&#xA0;029: <span class="sd">dS/dt = (P-I) - K_sat * (S/S_cap)**Beta - E_p * min(1, S/0.5S_cap) </span></pre>
<pre class='cython line score-0'>&#xA0;030: <span class="sd">----------------------------------------------- &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;031: </pre>
<pre class='cython line score-0'>&#xA0;032: </pre>
<pre class='cython line score-0'>&#xA0;033: <span class="c"># cython: profile=True</span></pre>
<pre class='cython line score-0'>&#xA0;034: <span class="c"># filename: Unsat_Zone.pyx</span></pre>
<pre class='cython line score-0'>&#xA0;035: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+036: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;037: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython line score-0'>&#xA0;038: </pre>
<pre class='cython line score-0'>&#xA0;039: </pre>
<pre class='cython line score-0'>&#xA0;040: <span class="c"># Define some C-function for more efficient computatation</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+041: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">double</span> <span class="nf">c_max</span><span class="p">(</span><span class="n">double</span> <span class="n">a</span><span class="p">,</span> <span class="n">double</span> <span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="n">b</span> <span class="k">else</span> <span class="n">b</span></pre>
<pre class='cython code score-0'>static CYTHON_INLINE double __pyx_f_5GWTSA_10unsat_zone_c_max(double __pyx_v_a, double __pyx_v_b) {
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("c_max", 0);
  if (((__pyx_v_a &gt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+042: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">double</span> <span class="nf">c_min</span><span class="p">(</span><span class="n">double</span> <span class="n">a</span><span class="p">,</span> <span class="n">double</span> <span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span> <span class="k">else</span> <span class="n">b</span></pre>
<pre class='cython code score-0'>static CYTHON_INLINE double __pyx_f_5GWTSA_10unsat_zone_c_min(double __pyx_v_a, double __pyx_v_b) {
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("c_min", 0);
  if (((__pyx_v_a &lt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;043: </pre>
<pre class='cython line score-0'>&#xA0;044: </pre>
<pre class='cython line score-182' onclick='toggleDiv(this)'>+045: <span class="k">def</span> <span class="nf">percolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_t</span><span class="p">]</span> <span class="n">Time_Model</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">P</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">E</span><span class="p">,</span> <span class="n">double</span> <span class="n">S_cap</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">double</span> <span class="n">K_sat</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">double</span> <span class="n">Beta</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">double</span> <span class="n">Imax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3</span><span class="p">,</span> <span class="nb">int</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">1</span><span class="p">,</span> <span class="nb">int</span> <span class="n">solver</span> <span class="o">=</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-182'>/* Python wrapper */
static PyObject *__pyx_pw_5GWTSA_10unsat_zone_1percolation(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_5GWTSA_10unsat_zone_1percolation = {"percolation", (PyCFunction)__pyx_pw_5GWTSA_10unsat_zone_1percolation, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_5GWTSA_10unsat_zone_1percolation(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_Time_Model = 0;
  PyArrayObject *__pyx_v_P = 0;
  PyArrayObject *__pyx_v_E = 0;
  double __pyx_v_S_cap;
  double __pyx_v_K_sat;
  double __pyx_v_Beta;
  double __pyx_v_Imax;
  int __pyx_v_dt;
  int __pyx_v_solver;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("percolation (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Time_Model,&amp;__pyx_n_s_P,&amp;__pyx_n_s_E,&amp;__pyx_n_s_S_cap,&amp;__pyx_n_s_K_sat,&amp;__pyx_n_s_Beta,&amp;__pyx_n_s_Imax,&amp;__pyx_n_s_dt,&amp;__pyx_n_s_solver,0};
    PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Time_Model)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_P)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("percolation", 0, 3, 9, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_E)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("percolation", 0, 3, 9, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_S_cap);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_K_sat);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Beta);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Imax);
          if (value) { values[6] = value; kw_args--; }
        }
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_dt);
          if (value) { values[7] = value; kw_args--; }
        }
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_solver);
          if (value) { values[8] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "percolation") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_Time_Model = ((PyArrayObject *)values[0]);
    __pyx_v_P = ((PyArrayObject *)values[1]);
    __pyx_v_E = ((PyArrayObject *)values[2]);
    if (values[3]) {
      __pyx_v_S_cap = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_S_cap == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_S_cap = ((double)1.0);
    }
    if (values[4]) {
      __pyx_v_K_sat = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_K_sat == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_K_sat = ((double)-1.5);
    }
    if (values[5]) {
      __pyx_v_Beta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_Beta == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_Beta = ((double)2.0);
    }
    if (values[6]) {
      __pyx_v_Imax = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_Imax == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_Imax = ((double)-3.0);
    }
    if (values[7]) {
      __pyx_v_dt = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]);<span class='error_goto'> if (unlikely((__pyx_v_dt == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_dt = ((int)1);
    }
    if (values[8]) {
      __pyx_v_solver = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]);<span class='error_goto'> if (unlikely((__pyx_v_solver == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_solver = ((int)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("percolation", 0, 3, 9, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("GWTSA.unsat_zone.percolation", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Time_Model), __pyx_ptype_5numpy_ndarray, 1, "Time_Model", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_P), __pyx_ptype_5numpy_ndarray, 1, "P", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_E), __pyx_ptype_5numpy_ndarray, 1, "E", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5GWTSA_10unsat_zone_percolation(__pyx_self, __pyx_v_Time_Model, __pyx_v_P, __pyx_v_E, __pyx_v_S_cap, __pyx_v_K_sat, __pyx_v_Beta, __pyx_v_Imax, __pyx_v_dt, __pyx_v_solver);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5GWTSA_10unsat_zone_percolation(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_Time_Model, PyArrayObject *__pyx_v_P, PyArrayObject *__pyx_v_E, double __pyx_v_S_cap, double __pyx_v_K_sat, double __pyx_v_Beta, double __pyx_v_Imax, int __pyx_v_dt, int __pyx_v_solver) {
  int __pyx_v_t;
  int __pyx_v_iteration;
  int __pyx_v_bisection;
  int __pyx_v_n;
  double __pyx_v_error;
  double __pyx_v_Last_S;
  double __pyx_v_g;
  double __pyx_v_g_derivative;
  double __pyx_v_a;
  double __pyx_v_b;
  double __pyx_v_c;
  PyArrayObject *__pyx_v_S = 0;
  PyArrayObject *__pyx_v_Si = 0;
  PyArrayObject *__pyx_v_Pe = 0;
  PyArrayObject *__pyx_v_Ei = 0;
  PyArrayObject *__pyx_v_Ep = 0;
  PyArrayObject *__pyx_v_R = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_E;
  __Pyx_Buffer __pyx_pybuffer_E;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Ei;
  __Pyx_Buffer __pyx_pybuffer_Ei;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Ep;
  __Pyx_Buffer __pyx_pybuffer_Ep;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_P;
  __Pyx_Buffer __pyx_pybuffer_P;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Pe;
  __Pyx_Buffer __pyx_pybuffer_Pe;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_R;
  __Pyx_Buffer __pyx_pybuffer_R;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S;
  __Pyx_Buffer __pyx_pybuffer_S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Si;
  __Pyx_Buffer __pyx_pybuffer_Si;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Time_Model;
  __Pyx_Buffer __pyx_pybuffer_Time_Model;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("percolation", 0);
  __pyx_pybuffer_S.pybuffer.buf = NULL;
  __pyx_pybuffer_S.refcount = 0;
  __pyx_pybuffernd_S.data = NULL;
  __pyx_pybuffernd_S.rcbuffer = &amp;__pyx_pybuffer_S;
  __pyx_pybuffer_Si.pybuffer.buf = NULL;
  __pyx_pybuffer_Si.refcount = 0;
  __pyx_pybuffernd_Si.data = NULL;
  __pyx_pybuffernd_Si.rcbuffer = &amp;__pyx_pybuffer_Si;
  __pyx_pybuffer_Pe.pybuffer.buf = NULL;
  __pyx_pybuffer_Pe.refcount = 0;
  __pyx_pybuffernd_Pe.data = NULL;
  __pyx_pybuffernd_Pe.rcbuffer = &amp;__pyx_pybuffer_Pe;
  __pyx_pybuffer_Ei.pybuffer.buf = NULL;
  __pyx_pybuffer_Ei.refcount = 0;
  __pyx_pybuffernd_Ei.data = NULL;
  __pyx_pybuffernd_Ei.rcbuffer = &amp;__pyx_pybuffer_Ei;
  __pyx_pybuffer_Ep.pybuffer.buf = NULL;
  __pyx_pybuffer_Ep.refcount = 0;
  __pyx_pybuffernd_Ep.data = NULL;
  __pyx_pybuffernd_Ep.rcbuffer = &amp;__pyx_pybuffer_Ep;
  __pyx_pybuffer_R.pybuffer.buf = NULL;
  __pyx_pybuffer_R.refcount = 0;
  __pyx_pybuffernd_R.data = NULL;
  __pyx_pybuffernd_R.rcbuffer = &amp;__pyx_pybuffer_R;
  __pyx_pybuffer_Time_Model.pybuffer.buf = NULL;
  __pyx_pybuffer_Time_Model.refcount = 0;
  __pyx_pybuffernd_Time_Model.data = NULL;
  __pyx_pybuffernd_Time_Model.rcbuffer = &amp;__pyx_pybuffer_Time_Model;
  __pyx_pybuffer_P.pybuffer.buf = NULL;
  __pyx_pybuffer_P.refcount = 0;
  __pyx_pybuffernd_P.data = NULL;
  __pyx_pybuffernd_P.rcbuffer = &amp;__pyx_pybuffer_P;
  __pyx_pybuffer_E.pybuffer.buf = NULL;
  __pyx_pybuffer_E.refcount = 0;
  __pyx_pybuffernd_E.data = NULL;
  __pyx_pybuffernd_E.rcbuffer = &amp;__pyx_pybuffer_E;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Time_Model.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Time_Model, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Time_Model.diminfo[0].strides = __pyx_pybuffernd_Time_Model.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Time_Model.diminfo[0].shape = __pyx_pybuffernd_Time_Model.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_P.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_P, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_P.diminfo[0].strides = __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_P.diminfo[0].shape = __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_E.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_E, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_E.diminfo[0].strides = __pyx_pybuffernd_E.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_E.diminfo[0].shape = __pyx_pybuffernd_E.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_71);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_E.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Ei.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_P.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_R.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Time_Model.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("GWTSA.unsat_zone.percolation", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_E.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Ei.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_P.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_R.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Time_Model.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Si);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Pe);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Ei);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Ep);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_R);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(26, __pyx_n_s_Time_Model, __pyx_n_s_P, __pyx_n_s_E, __pyx_n_s_S_cap, __pyx_n_s_K_sat, __pyx_n_s_Beta, __pyx_n_s_Imax, __pyx_n_s_dt, __pyx_n_s_solver, __pyx_n_s_t, __pyx_n_s_iteration, __pyx_n_s_bisection, __pyx_n_s_n, __pyx_n_s_error, __pyx_n_s_Last_S, __pyx_n_s_g, __pyx_n_s_g_derivative, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_c, __pyx_n_s_S, __pyx_n_s_Si, __pyx_n_s_Pe, __pyx_n_s_Ei, __pyx_n_s_Ep, __pyx_n_s_R);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_5GWTSA_10unsat_zone_1percolation, NULL, __pyx_n_s_GWTSA_unsat_zone);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_percolation, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;046: </pre>
<pre class='cython line score-0'>&#xA0;047:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">t</span><span class="p">,</span> <span class="nf">iteration</span><span class="p">,</span> <span class="nf">bisection</span><span class="p">,</span> <span class="nf">n</span></pre>
<pre class='cython line score-0'>&#xA0;048:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">error</span><span class="p">,</span> <span class="nf">Last_S</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">g_derivative</span><span class="p">,</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span><span class="p">,</span> <span class="nf">c</span></pre>
<pre class='cython line score-0'>&#xA0;049: </pre>
<pre class='cython line score-15' onclick='toggleDiv(this)'>+050:     <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Time_Model</span><span class="p">)</span> <span class="o">/</span> <span class="n">dt</span></pre>
<pre class='cython code score-15'>  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_Time_Model));<span class='error_goto'> if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(__pyx_v_dt == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  else if (sizeof(Py_ssize_t) == sizeof(long) &amp;&amp; (!(((int)-1) &gt; 0)) &amp;&amp; unlikely(__pyx_v_dt == (int)-1)  &amp;&amp; unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_t_1))) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_OverflowError, "value too large to perform division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_n = __Pyx_div_Py_ssize_t(__pyx_t_1, __pyx_v_dt);
</pre><pre class='cython line score-0'>&#xA0;051: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+052:     <span class="n">K_sat</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="n">K_sat</span></pre>
<pre class='cython code score-0'>  __pyx_v_K_sat = pow(10.0, __pyx_v_K_sat);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+053:     <span class="n">S_cap</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="n">S_cap</span></pre>
<pre class='cython code score-0'>  __pyx_v_S_cap = pow(10.0, __pyx_v_S_cap);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+054:     <span class="n">Imax</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="n">Imax</span></pre>
<pre class='cython code score-0'>  __pyx_v_Imax = pow(10.0, __pyx_v_Imax);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+055:     <span class="n">error</span> <span class="o">=</span> <span class="mf">1.0e-5</span></pre>
<pre class='cython code score-0'>  __pyx_v_error = 1.0e-5;
</pre><pre class='cython line score-0'>&#xA0;056: </pre>
<pre class='cython line score-0'>&#xA0;057:     <span class="c"># Create an empty array to store the soil state in</span></pre>
<pre class='cython line score-36' onclick='toggleDiv(this)'>+058:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">np</span>.<span class="kt">float_t</span>] <span class="nf">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></pre>
<pre class='cython code score-36'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_S = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_S = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+059:     <span class="n">S</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">S_cap</span>   <span class="c">#Set the initial system state</span></pre>
<pre class='cython code score-2'>  __pyx_t_8 = 0;
  __pyx_t_9 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_pybuffernd_S.diminfo[0].shape;
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_9 = 0;
  if (unlikely(__pyx_t_9 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_S.diminfo[0].strides) = (0.5 * __pyx_v_S_cap);
</pre><pre class='cython line score-36' onclick='toggleDiv(this)'>+060:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">np</span>.<span class="kt">float_t</span>] <span class="nf">Si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></pre>
<pre class='cython code score-36'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_10, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Si = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Si.diminfo[0].strides = __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Si.diminfo[0].shape = __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_Si = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+061:     <span class="n">Si</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-2'>  __pyx_t_11 = 0;
  __pyx_t_9 = -1;
  if (__pyx_t_11 &lt; 0) {
    __pyx_t_11 += __pyx_pybuffernd_Si.diminfo[0].shape;
    if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_9 = 0;
  } else if (unlikely(__pyx_t_11 &gt;= __pyx_pybuffernd_Si.diminfo[0].shape)) __pyx_t_9 = 0;
  if (unlikely(__pyx_t_9 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Si.diminfo[0].strides) = 0.0;
</pre><pre class='cython line score-36' onclick='toggleDiv(this)'>+062:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">np</span>.<span class="kt">float_t</span>] <span class="nf">Pe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></pre>
<pre class='cython code score-36'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Pe = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Pe.diminfo[0].strides = __pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Pe.diminfo[0].shape = __pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_Pe = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+063:     <span class="n">Pe</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-2'>  __pyx_t_13 = 0;
  __pyx_t_9 = -1;
  if (__pyx_t_13 &lt; 0) {
    __pyx_t_13 += __pyx_pybuffernd_Pe.diminfo[0].shape;
    if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_9 = 0;
  } else if (unlikely(__pyx_t_13 &gt;= __pyx_pybuffernd_Pe.diminfo[0].shape)) __pyx_t_9 = 0;
  if (unlikely(__pyx_t_9 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Pe.diminfo[0].strides) = 0.0;
</pre><pre class='cython line score-36' onclick='toggleDiv(this)'>+064:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">np</span>.<span class="kt">float_t</span>] <span class="nf">Ei</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></pre>
<pre class='cython code score-36'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Ei.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_14, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Ei = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Ei.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Ei.diminfo[0].strides = __pyx_pybuffernd_Ei.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Ei.diminfo[0].shape = __pyx_pybuffernd_Ei.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_Ei = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+065:     <span class="n">Ei</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-2'>  __pyx_t_15 = 0;
  __pyx_t_9 = -1;
  if (__pyx_t_15 &lt; 0) {
    __pyx_t_15 += __pyx_pybuffernd_Ei.diminfo[0].shape;
    if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_9 = 0;
  } else if (unlikely(__pyx_t_15 &gt;= __pyx_pybuffernd_Ei.diminfo[0].shape)) __pyx_t_9 = 0;
  if (unlikely(__pyx_t_9 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ei.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_Ei.diminfo[0].strides) = 0.0;
</pre><pre class='cython line score-36' onclick='toggleDiv(this)'>+066:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">np</span>.<span class="kt">float_t</span>] <span class="nf">Ep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></pre>
<pre class='cython code score-36'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_16 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_16, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Ep = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_Ep.diminfo[0].strides = __pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Ep.diminfo[0].shape = __pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_16 = 0;
  __pyx_v_Ep = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+067:     <span class="n">Ep</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-2'>  __pyx_t_17 = 0;
  __pyx_t_9 = -1;
  if (__pyx_t_17 &lt; 0) {
    __pyx_t_17 += __pyx_pybuffernd_Ep.diminfo[0].shape;
    if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_9 = 0;
  } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_Ep.diminfo[0].shape)) __pyx_t_9 = 0;
  if (unlikely(__pyx_t_9 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Ep.diminfo[0].strides) = 0.0;
</pre><pre class='cython line score-0'>&#xA0;068: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+069:     <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_18 = (__pyx_v_n - 1);
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_18; __pyx_t_9+=1) {
    __pyx_v_t = __pyx_t_9;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+070:         <span class="n">Si</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Si</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">P</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span>                <span class="c"># Fill interception bucket with new rain</span></pre>
<pre class='cython code score-6'>    __pyx_t_19 = __pyx_v_t;
    __pyx_t_20 = -1;
    if (__pyx_t_19 &lt; 0) {
      __pyx_t_19 += __pyx_pybuffernd_Si.diminfo[0].shape;
      if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_Si.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_21 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_21 &lt; 0) {
      __pyx_t_21 += __pyx_pybuffernd_P.diminfo[0].shape;
      if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_21 &gt;= __pyx_pybuffernd_P.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_22 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_22 &lt; 0) {
      __pyx_t_22 += __pyx_pybuffernd_Si.diminfo[0].shape;
      if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_22 &gt;= __pyx_pybuffernd_Si.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_Si.diminfo[0].strides) = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Si.diminfo[0].strides)) + (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_P.diminfo[0].strides)));
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+071:         <span class="n">Pe</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Si</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">Imax</span><span class="p">)</span>    <span class="c"># Calculate effective precipitation</span></pre>
<pre class='cython code score-4'>    __pyx_t_23 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_23 &lt; 0) {
      __pyx_t_23 += __pyx_pybuffernd_Si.diminfo[0].shape;
      if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_23 &gt;= __pyx_pybuffernd_Si.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_24 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_24 &lt; 0) {
      __pyx_t_24 += __pyx_pybuffernd_Pe.diminfo[0].shape;
      if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_24 &gt;= __pyx_pybuffernd_Pe.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_Pe.diminfo[0].strides) = __pyx_f_5GWTSA_10unsat_zone_c_max(0.0, ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_Si.diminfo[0].strides)) - __pyx_v_Imax));
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+072:         <span class="n">Si</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Si</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">Pe</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-6'>    __pyx_t_25 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_25 &lt; 0) {
      __pyx_t_25 += __pyx_pybuffernd_Si.diminfo[0].shape;
      if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_25 &gt;= __pyx_pybuffernd_Si.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_26 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_26 &lt; 0) {
      __pyx_t_26 += __pyx_pybuffernd_Pe.diminfo[0].shape;
      if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_26 &gt;= __pyx_pybuffernd_Pe.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_27 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_27 &lt; 0) {
      __pyx_t_27 += __pyx_pybuffernd_Si.diminfo[0].shape;
      if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_27 &gt;= __pyx_pybuffernd_Si.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_Si.diminfo[0].strides) = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_Si.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_Pe.diminfo[0].strides)));
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+073:         <span class="n">Ei</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_min</span><span class="p">(</span><span class="n">Si</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">])</span>       <span class="c"># Evaporation from interception</span></pre>
<pre class='cython code score-6'>    __pyx_t_28 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_28 &lt; 0) {
      __pyx_t_28 += __pyx_pybuffernd_Si.diminfo[0].shape;
      if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_28 &gt;= __pyx_pybuffernd_Si.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_29 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_29 &lt; 0) {
      __pyx_t_29 += __pyx_pybuffernd_E.diminfo[0].shape;
      if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_29 &gt;= __pyx_pybuffernd_E.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_30 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_30 &lt; 0) {
      __pyx_t_30 += __pyx_pybuffernd_Ei.diminfo[0].shape;
      if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_30 &gt;= __pyx_pybuffernd_Ei.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ei.rcbuffer-&gt;pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_Ei.diminfo[0].strides) = __pyx_f_5GWTSA_10unsat_zone_c_min((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_Si.diminfo[0].strides)), (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_E.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_E.diminfo[0].strides)));
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+074:         <span class="n">Si</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Si</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">Ei</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span>             <span class="c"># Update interception state</span></pre>
<pre class='cython code score-6'>    __pyx_t_31 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_31 &lt; 0) {
      __pyx_t_31 += __pyx_pybuffernd_Si.diminfo[0].shape;
      if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_31 &gt;= __pyx_pybuffernd_Si.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_32 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_32 &lt; 0) {
      __pyx_t_32 += __pyx_pybuffernd_Ei.diminfo[0].shape;
      if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_32 &gt;= __pyx_pybuffernd_Ei.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_33 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_33 &lt; 0) {
      __pyx_t_33 += __pyx_pybuffernd_Si.diminfo[0].shape;
      if (unlikely(__pyx_t_33 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_33 &gt;= __pyx_pybuffernd_Si.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_Si.diminfo[0].strides) = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Si.rcbuffer-&gt;pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_Si.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ei.rcbuffer-&gt;pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_Ei.diminfo[0].strides)));
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+075:         <span class="n">Ep</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">Ei</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span>             <span class="c"># Update potential evapotranspiration    </span></pre>
<pre class='cython code score-6'>    __pyx_t_34 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_34 &lt; 0) {
      __pyx_t_34 += __pyx_pybuffernd_E.diminfo[0].shape;
      if (unlikely(__pyx_t_34 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_34 &gt;= __pyx_pybuffernd_E.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_35 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_35 &lt; 0) {
      __pyx_t_35 += __pyx_pybuffernd_Ei.diminfo[0].shape;
      if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_35 &gt;= __pyx_pybuffernd_Ei.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_36 = (__pyx_v_t + 1);
    __pyx_t_20 = -1;
    if (__pyx_t_36 &lt; 0) {
      __pyx_t_36 += __pyx_pybuffernd_Ep.diminfo[0].shape;
      if (unlikely(__pyx_t_36 &lt; 0)) __pyx_t_20 = 0;
    } else if (unlikely(__pyx_t_36 &gt;= __pyx_pybuffernd_Ep.diminfo[0].shape)) __pyx_t_20 = 0;
    if (unlikely(__pyx_t_20 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer.buf, __pyx_t_36, __pyx_pybuffernd_Ep.diminfo[0].strides) = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_E.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_E.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ei.rcbuffer-&gt;pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_Ei.diminfo[0].strides)));
</pre><pre class='cython line score-0'>&#xA0;076: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+077:         <span class="n">Last_S</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span></pre>
<pre class='cython code score-2'>    __pyx_t_20 = __pyx_v_t;
    __pyx_t_37 = -1;
    if (__pyx_t_20 &lt; 0) {
      __pyx_t_20 += __pyx_pybuffernd_S.diminfo[0].shape;
      if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_37 = 0;
    } else if (unlikely(__pyx_t_20 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_37 = 0;
    if (unlikely(__pyx_t_37 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_37);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_v_Last_S = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_S.diminfo[0].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+078:         <span class="n">iteration</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>    __pyx_v_iteration = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+079:         <span class="n">bisection</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_bisection = 1;
</pre><pre class='cython line score-0'>&#xA0;080:         <span class="c">#Use explicit Euler scheme to find an initial estimate for the newton raphson-method</span></pre>
<pre class='cython line score-0'>&#xA0;081: </pre>
<pre class='cython line score-22' onclick='toggleDiv(this)'>+082:         <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span> <span class="n">Pe</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">K_sat</span> <span class="o">*</span> <span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">/</span> <span class="n">S_cap</span><span class="p">)</span><span class="o">**</span><span class="n">Beta</span> <span class="o">-</span> <span class="n">Ep</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">c_min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S_cap</span><span class="p">))</span> <span class="p">)))</span></pre>
<pre class='cython code score-22'>    __pyx_t_37 = __pyx_v_t;
    __pyx_t_38 = -1;
    if (__pyx_t_37 &lt; 0) {
      __pyx_t_37 += __pyx_pybuffernd_S.diminfo[0].shape;
      if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_38 = 0;
    } else if (unlikely(__pyx_t_37 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_38 = 0;
    if (unlikely(__pyx_t_38 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_38);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_38 = __pyx_v_t;
    __pyx_t_39 = -1;
    if (__pyx_t_38 &lt; 0) {
      __pyx_t_38 += __pyx_pybuffernd_Pe.diminfo[0].shape;
      if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_39 = 0;
    } else if (unlikely(__pyx_t_38 &gt;= __pyx_pybuffernd_Pe.diminfo[0].shape)) __pyx_t_39 = 0;
    if (unlikely(__pyx_t_39 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_39);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_39 = __pyx_v_t;
    __pyx_t_40 = -1;
    if (__pyx_t_39 &lt; 0) {
      __pyx_t_39 += __pyx_pybuffernd_S.diminfo[0].shape;
      if (unlikely(__pyx_t_39 &lt; 0)) __pyx_t_40 = 0;
    } else if (unlikely(__pyx_t_39 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_40 = 0;
    if (unlikely(__pyx_t_40 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_40);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_41 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_S.diminfo[0].strides));
    if (unlikely(__pyx_v_S_cap == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_40 = __pyx_v_t;
    __pyx_t_42 = -1;
    if (__pyx_t_40 &lt; 0) {
      __pyx_t_40 += __pyx_pybuffernd_Ep.diminfo[0].shape;
      if (unlikely(__pyx_t_40 &lt; 0)) __pyx_t_42 = 0;
    } else if (unlikely(__pyx_t_40 &gt;= __pyx_pybuffernd_Ep.diminfo[0].shape)) __pyx_t_42 = 0;
    if (unlikely(__pyx_t_42 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_42);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_42 = __pyx_v_t;
    __pyx_t_43 = -1;
    if (__pyx_t_42 &lt; 0) {
      __pyx_t_42 += __pyx_pybuffernd_S.diminfo[0].shape;
      if (unlikely(__pyx_t_42 &lt; 0)) __pyx_t_43 = 0;
    } else if (unlikely(__pyx_t_42 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_43 = 0;
    if (unlikely(__pyx_t_43 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_43);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_44 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_42, __pyx_pybuffernd_S.diminfo[0].strides));
    __pyx_t_45 = (0.5 * __pyx_v_S_cap);
    if (unlikely(__pyx_t_45 == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_46 = (__pyx_v_t + 1);
    __pyx_t_43 = -1;
    if (__pyx_t_46 &lt; 0) {
      __pyx_t_46 += __pyx_pybuffernd_S.diminfo[0].shape;
      if (unlikely(__pyx_t_46 &lt; 0)) __pyx_t_43 = 0;
    } else if (unlikely(__pyx_t_46 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_43 = 0;
    if (unlikely(__pyx_t_43 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_43);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_S.diminfo[0].strides) = __pyx_f_5GWTSA_10unsat_zone_c_max(0.0, ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_S.diminfo[0].strides)) + (__pyx_v_dt * (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer.buf, __pyx_t_38, __pyx_pybuffernd_Pe.diminfo[0].strides)) - (__pyx_v_K_sat * pow((__pyx_t_41 / __pyx_v_S_cap), __pyx_v_Beta))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_Ep.diminfo[0].strides)) * __pyx_f_5GWTSA_10unsat_zone_c_min(1.0, (__pyx_t_44 / __pyx_t_45)))))));
</pre><pre class='cython line score-0'>&#xA0;083: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+084:         <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_47 = ((__pyx_v_solver == 1) != 0);
    if (__pyx_t_47) {
</pre><pre class='cython line score-0'>&#xA0;085:             <span class="c">#Start the while loop for the newton-Raphson iteration   </span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+086:             <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Last_S</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">error</span><span class="p">:</span></pre>
<pre class='cython code score-2'>      while (1) {
        __pyx_t_48 = (__pyx_v_t + 1);
        __pyx_t_43 = -1;
        if (__pyx_t_48 &lt; 0) {
          __pyx_t_48 += __pyx_pybuffernd_S.diminfo[0].shape;
          if (unlikely(__pyx_t_48 &lt; 0)) __pyx_t_43 = 0;
        } else if (unlikely(__pyx_t_48 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_43 = 0;
        if (unlikely(__pyx_t_43 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_43);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_47 = ((fabs((__pyx_v_Last_S - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_48, __pyx_pybuffernd_S.diminfo[0].strides)))) &gt; __pyx_v_error) != 0);
        if (!__pyx_t_47) break;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+087:                 <span class="k">if</span> <span class="n">iteration</span> <span class="o">&gt;</span> <span class="mf">100</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        __pyx_t_47 = ((__pyx_v_iteration &gt; 100) != 0);
        if (__pyx_t_47) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+088:                     <span class="k">break</span> <span class="c">#Check if the number of iterations is not too high  </span></pre>
<pre class='cython code score-0'>          goto __pyx_L7_break;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+089:                 <span class="n">iteration</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>        __pyx_v_iteration = (__pyx_v_iteration + 1);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+090:                 <span class="n">Last_S</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2'>        __pyx_t_49 = (__pyx_v_t + 1);
        __pyx_t_43 = -1;
        if (__pyx_t_49 &lt; 0) {
          __pyx_t_49 += __pyx_pybuffernd_S.diminfo[0].shape;
          if (unlikely(__pyx_t_49 &lt; 0)) __pyx_t_43 = 0;
        } else if (unlikely(__pyx_t_49 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_43 = 0;
        if (unlikely(__pyx_t_43 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_43);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_Last_S = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_49, __pyx_pybuffernd_S.diminfo[0].strides));
</pre><pre class='cython line score-0'>&#xA0;091: </pre>
<pre class='cython line score-16' onclick='toggleDiv(this)'>+092:                 <span class="n">g</span> <span class="o">=</span> <span class="n">Last_S</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span><span class="p">(</span> <span class="n">Pe</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">K_sat</span> <span class="o">*</span> <span class="p">(</span><span class="n">Last_S</span> <span class="o">/</span> <span class="n">S_cap</span><span class="p">)</span><span class="o">**</span><span class="n">Beta</span> <span class="o">-</span> <span class="n">Ep</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">c_min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="p">(</span><span class="n">Last_S</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S_cap</span><span class="p">)))</span> <span class="p">)</span></pre>
<pre class='cython code score-16'>        __pyx_t_43 = __pyx_v_t;
        __pyx_t_50 = -1;
        if (__pyx_t_43 &lt; 0) {
          __pyx_t_43 += __pyx_pybuffernd_S.diminfo[0].shape;
          if (unlikely(__pyx_t_43 &lt; 0)) __pyx_t_50 = 0;
        } else if (unlikely(__pyx_t_43 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_50 = 0;
        if (unlikely(__pyx_t_50 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_50);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_50 = __pyx_v_t;
        __pyx_t_51 = -1;
        if (__pyx_t_50 &lt; 0) {
          __pyx_t_50 += __pyx_pybuffernd_Pe.diminfo[0].shape;
          if (unlikely(__pyx_t_50 &lt; 0)) __pyx_t_51 = 0;
        } else if (unlikely(__pyx_t_50 &gt;= __pyx_pybuffernd_Pe.diminfo[0].shape)) __pyx_t_51 = 0;
        if (unlikely(__pyx_t_51 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_51);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        if (unlikely(__pyx_v_S_cap == 0)) {
          #ifdef WITH_THREAD
          PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
          #endif
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_51 = __pyx_v_t;
        __pyx_t_52 = -1;
        if (__pyx_t_51 &lt; 0) {
          __pyx_t_51 += __pyx_pybuffernd_Ep.diminfo[0].shape;
          if (unlikely(__pyx_t_51 &lt; 0)) __pyx_t_52 = 0;
        } else if (unlikely(__pyx_t_51 &gt;= __pyx_pybuffernd_Ep.diminfo[0].shape)) __pyx_t_52 = 0;
        if (unlikely(__pyx_t_52 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_52);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_45 = (0.5 * __pyx_v_S_cap);
        if (unlikely(__pyx_t_45 == 0)) {
          #ifdef WITH_THREAD
          PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
          #endif
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_g = ((__pyx_v_Last_S - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_43, __pyx_pybuffernd_S.diminfo[0].strides))) - (__pyx_v_dt * (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer.buf, __pyx_t_50, __pyx_pybuffernd_Pe.diminfo[0].strides)) - (__pyx_v_K_sat * pow((__pyx_v_Last_S / __pyx_v_S_cap), __pyx_v_Beta))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer.buf, __pyx_t_51, __pyx_pybuffernd_Ep.diminfo[0].strides)) * __pyx_f_5GWTSA_10unsat_zone_c_min(1.0, (__pyx_v_Last_S / __pyx_t_45))))));
</pre><pre class='cython line score-0'>&#xA0;093:                 <span class="c"># Derivative depends on the state of the system</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+094:                 <span class="k">if</span> <span class="n">Last_S</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S_cap</span><span class="p">):</span></pre>
<pre class='cython code score-0'>        __pyx_t_47 = ((__pyx_v_Last_S &gt; (0.5 * __pyx_v_S_cap)) != 0);
        if (__pyx_t_47) {
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+095:                     <span class="n">g_derivative</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span> <span class="o">-</span><span class="n">Beta</span> <span class="o">*</span> <span class="n">K_sat</span> <span class="o">*</span> <span class="p">(</span><span class="n">Last_S</span> <span class="o">/</span> <span class="n">S_cap</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">Beta</span><span class="o">-</span><span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-5'>          if (unlikely(__pyx_v_S_cap == 0)) {
            #ifdef WITH_THREAD
            PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
            #endif
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_v_g_derivative = (1.0 - (__pyx_v_dt * (((-__pyx_v_Beta) * __pyx_v_K_sat) * pow((__pyx_v_Last_S / __pyx_v_S_cap), (__pyx_v_Beta - 1.0)))));
          goto __pyx_L9;
        }
        /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;096:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+097:                     <span class="n">g_derivative</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span> <span class="o">-</span><span class="n">Beta</span> <span class="o">*</span> <span class="n">K_sat</span> <span class="o">*</span> <span class="p">(</span><span class="n">Last_S</span> <span class="o">/</span> <span class="n">S_cap</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">Beta</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ep</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S_cap</span><span class="p">)</span> <span class="p">)</span></pre>
<pre class='cython code score-7'>          if (unlikely(__pyx_v_S_cap == 0)) {
            #ifdef WITH_THREAD
            PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
            #endif
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_52 = __pyx_v_t;
          __pyx_t_53 = -1;
          if (__pyx_t_52 &lt; 0) {
            __pyx_t_52 += __pyx_pybuffernd_Ep.diminfo[0].shape;
            if (unlikely(__pyx_t_52 &lt; 0)) __pyx_t_53 = 0;
          } else if (unlikely(__pyx_t_52 &gt;= __pyx_pybuffernd_Ep.diminfo[0].shape)) __pyx_t_53 = 0;
          if (unlikely(__pyx_t_53 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_53);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_v_g_derivative = (1.0 - (__pyx_v_dt * ((((-__pyx_v_Beta) * __pyx_v_K_sat) * pow((__pyx_v_Last_S / __pyx_v_S_cap), (__pyx_v_Beta - 1.0))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer.buf, __pyx_t_52, __pyx_pybuffernd_Ep.diminfo[0].strides)) * (0.5 * __pyx_v_S_cap)))));
        }
        __pyx_L9:;
</pre><pre class='cython line score-0'>&#xA0;098: </pre>
<pre class='cython line score-0'>&#xA0;099:                 <span class="c"># Check if there is no zero-division error            </span></pre>
<pre class='cython line score-42' onclick='toggleDiv(this)'>+100:                 <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">g</span> <span class="o">/</span> <span class="n">g_derivative</span><span class="p">):</span></pre>
<pre class='cython code score-42'>        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(__pyx_v_g_derivative == 0)) {
          #ifdef WITH_THREAD
          PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
          #endif
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_g / __pyx_v_g_derivative));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_3 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
          __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
          if (likely(__pyx_t_3)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          }
        }
        if (!__pyx_t_3) {
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        } else {
          __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_4);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          __pyx_t_4 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_47 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_47 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (__pyx_t_47) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+101:                     <span class="n">bisection</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_v_bisection = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+102:                     <span class="k">break</span></pre>
<pre class='cython code score-0'>          goto __pyx_L7_break;
        }
        /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;103:                 <span class="c"># if there is no zero-division error                </span></pre>
<pre class='cython line score-0'>&#xA0;104:                 <span class="k">else</span><span class="p">:</span> <span class="c"># use newton raphson</span></pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+105:                     <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Last_S</span> <span class="o">-</span> <span class="n">g</span> <span class="o">/</span> <span class="n">g_derivative</span></pre>
<pre class='cython code score-7'>          if (unlikely(__pyx_v_g_derivative == 0)) {
            #ifdef WITH_THREAD
            PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
            #endif
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_54 = (__pyx_v_t + 1);
          __pyx_t_53 = -1;
          if (__pyx_t_54 &lt; 0) {
            __pyx_t_54 += __pyx_pybuffernd_S.diminfo[0].shape;
            if (unlikely(__pyx_t_54 &lt; 0)) __pyx_t_53 = 0;
          } else if (unlikely(__pyx_t_54 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_53 = 0;
          if (unlikely(__pyx_t_53 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_53);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_54, __pyx_pybuffernd_S.diminfo[0].strides) = (__pyx_v_Last_S - (__pyx_v_g / __pyx_v_g_derivative));
        }
      }
      __pyx_L7_break:;
</pre><pre class='cython line score-0'>&#xA0;106: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+107:             <span class="k">if</span> <span class="n">bisection</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_47 = ((__pyx_v_bisection == 0) != 0);
      if (__pyx_t_47) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+108:                 <span class="n">iteration</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>        __pyx_v_iteration = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+109:                 <span class="n">a</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span></pre>
<pre class='cython code score-2'>        __pyx_t_53 = __pyx_v_t;
        __pyx_t_55 = -1;
        if (__pyx_t_53 &lt; 0) {
          __pyx_t_53 += __pyx_pybuffernd_S.diminfo[0].shape;
          if (unlikely(__pyx_t_53 &lt; 0)) __pyx_t_55 = 0;
        } else if (unlikely(__pyx_t_53 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_55 = 0;
        if (unlikely(__pyx_t_55 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_55);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_a = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_53, __pyx_pybuffernd_S.diminfo[0].strides));
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+110:                 <span class="n">b</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2'>        __pyx_t_56 = (__pyx_v_t + 1);
        __pyx_t_55 = -1;
        if (__pyx_t_56 &lt; 0) {
          __pyx_t_56 += __pyx_pybuffernd_S.diminfo[0].shape;
          if (unlikely(__pyx_t_56 &lt; 0)) __pyx_t_55 = 0;
        } else if (unlikely(__pyx_t_56 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_55 = 0;
        if (unlikely(__pyx_t_55 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_55);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_b = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_56, __pyx_pybuffernd_S.diminfo[0].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+111:                 <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">/</span> <span class="mf">2.0</span></pre>
<pre class='cython code score-0'>        __pyx_v_c = (__pyx_v_a + (__pyx_v_b / 2.0));
</pre><pre class='cython line score-0'>&#xA0;112: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+113:                 <span class="k">while</span> <span class="p">((</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">error</span><span class="p">:</span></pre>
<pre class='cython code score-0'>        while (1) {
          __pyx_t_47 = ((((__pyx_v_b - __pyx_v_a) / 2.0) &gt; __pyx_v_error) != 0);
          if (!__pyx_t_47) break;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+114:                     <span class="k">if</span> <span class="n">iteration</span> <span class="o">&gt;</span> <span class="mf">100</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_47 = ((__pyx_v_iteration &gt; 100) != 0);
          if (__pyx_t_47) {
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+115:                         <span class="k">print</span> <span class="s">&#39;iteration in bisection method exceeded 100&#39;</span><span class="p">,</span> <span class="n">iteration</span></pre>
<pre class='cython code score-13'>            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_iteration);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_iteration_in_bisection_method_ex);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_kp_s_iteration_in_bisection_method_ex);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_iteration_in_bisection_method_ex);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
            __pyx_t_2 = 0;
            if (<span class='pyx_c_api'>__Pyx_Print</span>(0, __pyx_t_6, 1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+116:                         <span class="k">break</span></pre>
<pre class='cython code score-0'>            goto __pyx_L13_break;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+117:                     <span class="n">iteration</span> <span class="o">+=</span> <span class="mf">1</span> <span class="c">#increase the number of iterations by 1</span></pre>
<pre class='cython code score-0'>          __pyx_v_iteration = (__pyx_v_iteration + 1);
</pre><pre class='cython line score-0'>&#xA0;118: </pre>
<pre class='cython line score-16' onclick='toggleDiv(this)'>+119:                     <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span><span class="p">(</span> <span class="n">Pe</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">K_sat</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">/</span> <span class="n">S_cap</span><span class="p">)</span><span class="o">**</span><span class="n">Beta</span> <span class="o">-</span> <span class="n">Ep</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">c_min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S_cap</span><span class="p">)))</span> <span class="p">))</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span></pre>
<pre class='cython code score-16'>          __pyx_t_55 = __pyx_v_t;
          __pyx_t_57 = -1;
          if (__pyx_t_55 &lt; 0) {
            __pyx_t_55 += __pyx_pybuffernd_S.diminfo[0].shape;
            if (unlikely(__pyx_t_55 &lt; 0)) __pyx_t_57 = 0;
          } else if (unlikely(__pyx_t_55 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_57 = 0;
          if (unlikely(__pyx_t_57 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_57);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_57 = __pyx_v_t;
          __pyx_t_58 = -1;
          if (__pyx_t_57 &lt; 0) {
            __pyx_t_57 += __pyx_pybuffernd_Pe.diminfo[0].shape;
            if (unlikely(__pyx_t_57 &lt; 0)) __pyx_t_58 = 0;
          } else if (unlikely(__pyx_t_57 &gt;= __pyx_pybuffernd_Pe.diminfo[0].shape)) __pyx_t_58 = 0;
          if (unlikely(__pyx_t_58 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_58);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          if (unlikely(__pyx_v_S_cap == 0)) {
            #ifdef WITH_THREAD
            PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
            #endif
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_58 = __pyx_v_t;
          __pyx_t_59 = -1;
          if (__pyx_t_58 &lt; 0) {
            __pyx_t_58 += __pyx_pybuffernd_Ep.diminfo[0].shape;
            if (unlikely(__pyx_t_58 &lt; 0)) __pyx_t_59 = 0;
          } else if (unlikely(__pyx_t_58 &gt;= __pyx_pybuffernd_Ep.diminfo[0].shape)) __pyx_t_59 = 0;
          if (unlikely(__pyx_t_59 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_59);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_45 = (0.5 * __pyx_v_S_cap);
          if (unlikely(__pyx_t_45 == 0)) {
            #ifdef WITH_THREAD
            PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
            #endif
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_47 = ((((__pyx_v_c - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_55, __pyx_pybuffernd_S.diminfo[0].strides))) - (__pyx_v_dt * (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_Pe.diminfo[0].strides)) - (__pyx_v_K_sat * pow((__pyx_v_c / __pyx_v_S_cap), __pyx_v_Beta))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer.buf, __pyx_t_58, __pyx_pybuffernd_Ep.diminfo[0].strides)) * __pyx_f_5GWTSA_10unsat_zone_c_min(1.0, (__pyx_v_c / __pyx_t_45)))))) == 0.0) != 0);
          if (__pyx_t_47) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+120:                         <span class="k">return</span> <span class="n">c</span> <span class="c"># Return the current value if it is correct</span></pre>
<pre class='cython code score-6'>            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
            __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_c);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            __pyx_r = __pyx_t_6;
            __pyx_t_6 = 0;
            goto __pyx_L0;
          }
</pre><pre class='cython line score-32' onclick='toggleDiv(this)'>+121:                     <span class="k">elif</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span><span class="p">(</span> <span class="n">Pe</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">K_sat</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">S_cap</span><span class="p">)</span><span class="o">**</span><span class="n">Beta</span> <span class="o">-</span> <span class="n">Ep</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">c_min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S_cap</span><span class="p">)))</span> <span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span><span class="p">(</span> <span class="n">Pe</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">K_sat</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">/</span> <span class="n">S_cap</span><span class="p">)</span><span class="o">**</span><span class="n">Beta</span> <span class="o">-</span> <span class="n">Ep</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">c_min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S_cap</span><span class="p">)))</span> <span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.0</span> <span class="p">:</span></pre>
<pre class='cython code score-32'>          __pyx_t_59 = __pyx_v_t;
          __pyx_t_60 = -1;
          if (__pyx_t_59 &lt; 0) {
            __pyx_t_59 += __pyx_pybuffernd_S.diminfo[0].shape;
            if (unlikely(__pyx_t_59 &lt; 0)) __pyx_t_60 = 0;
          } else if (unlikely(__pyx_t_59 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_60 = 0;
          if (unlikely(__pyx_t_60 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_60);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_60 = __pyx_v_t;
          __pyx_t_61 = -1;
          if (__pyx_t_60 &lt; 0) {
            __pyx_t_60 += __pyx_pybuffernd_Pe.diminfo[0].shape;
            if (unlikely(__pyx_t_60 &lt; 0)) __pyx_t_61 = 0;
          } else if (unlikely(__pyx_t_60 &gt;= __pyx_pybuffernd_Pe.diminfo[0].shape)) __pyx_t_61 = 0;
          if (unlikely(__pyx_t_61 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_61);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          if (unlikely(__pyx_v_S_cap == 0)) {
            #ifdef WITH_THREAD
            PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
            #endif
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_61 = __pyx_v_t;
          __pyx_t_62 = -1;
          if (__pyx_t_61 &lt; 0) {
            __pyx_t_61 += __pyx_pybuffernd_Ep.diminfo[0].shape;
            if (unlikely(__pyx_t_61 &lt; 0)) __pyx_t_62 = 0;
          } else if (unlikely(__pyx_t_61 &gt;= __pyx_pybuffernd_Ep.diminfo[0].shape)) __pyx_t_62 = 0;
          if (unlikely(__pyx_t_62 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_62);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_45 = (0.5 * __pyx_v_S_cap);
          if (unlikely(__pyx_t_45 == 0)) {
            #ifdef WITH_THREAD
            PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
            #endif
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_62 = __pyx_v_t;
          __pyx_t_63 = -1;
          if (__pyx_t_62 &lt; 0) {
            __pyx_t_62 += __pyx_pybuffernd_S.diminfo[0].shape;
            if (unlikely(__pyx_t_62 &lt; 0)) __pyx_t_63 = 0;
          } else if (unlikely(__pyx_t_62 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_63 = 0;
          if (unlikely(__pyx_t_63 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_63);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_63 = __pyx_v_t;
          __pyx_t_64 = -1;
          if (__pyx_t_63 &lt; 0) {
            __pyx_t_63 += __pyx_pybuffernd_Pe.diminfo[0].shape;
            if (unlikely(__pyx_t_63 &lt; 0)) __pyx_t_64 = 0;
          } else if (unlikely(__pyx_t_63 &gt;= __pyx_pybuffernd_Pe.diminfo[0].shape)) __pyx_t_64 = 0;
          if (unlikely(__pyx_t_64 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          if (unlikely(__pyx_v_S_cap == 0)) {
            #ifdef WITH_THREAD
            PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
            #endif
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_64 = __pyx_v_t;
          __pyx_t_65 = -1;
          if (__pyx_t_64 &lt; 0) {
            __pyx_t_64 += __pyx_pybuffernd_Ep.diminfo[0].shape;
            if (unlikely(__pyx_t_64 &lt; 0)) __pyx_t_65 = 0;
          } else if (unlikely(__pyx_t_64 &gt;= __pyx_pybuffernd_Ep.diminfo[0].shape)) __pyx_t_65 = 0;
          if (unlikely(__pyx_t_65 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_65);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_66 = (0.5 * __pyx_v_S_cap);
          if (unlikely(__pyx_t_66 == 0)) {
            #ifdef WITH_THREAD
            PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
            #endif
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_47 = (((((__pyx_v_a - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_59, __pyx_pybuffernd_S.diminfo[0].strides))) - (__pyx_v_dt * (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer.buf, __pyx_t_60, __pyx_pybuffernd_Pe.diminfo[0].strides)) - (__pyx_v_K_sat * pow((__pyx_v_a / __pyx_v_S_cap), __pyx_v_Beta))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer.buf, __pyx_t_61, __pyx_pybuffernd_Ep.diminfo[0].strides)) * __pyx_f_5GWTSA_10unsat_zone_c_min(1.0, (__pyx_v_a / __pyx_t_45)))))) * ((__pyx_v_c - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_62, __pyx_pybuffernd_S.diminfo[0].strides))) - (__pyx_v_dt * (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Pe.rcbuffer-&gt;pybuffer.buf, __pyx_t_63, __pyx_pybuffernd_Pe.diminfo[0].strides)) - (__pyx_v_K_sat * pow((__pyx_v_c / __pyx_v_S_cap), __pyx_v_Beta))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_Ep.rcbuffer-&gt;pybuffer.buf, __pyx_t_64, __pyx_pybuffernd_Ep.diminfo[0].strides)) * __pyx_f_5GWTSA_10unsat_zone_c_min(1.0, (__pyx_v_c / __pyx_t_66))))))) &gt; 0.0) != 0);
          if (__pyx_t_47) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+122:                         <span class="n">b</span> <span class="o">=</span> <span class="n">c</span></pre>
<pre class='cython code score-0'>            __pyx_v_b = __pyx_v_c;
            goto __pyx_L15;
          }
          /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;123:                     <span class="k">else</span> <span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+124:                         <span class="n">a</span> <span class="o">=</span> <span class="n">c</span></pre>
<pre class='cython code score-0'>            __pyx_v_a = __pyx_v_c;
          }
          __pyx_L15:;
</pre><pre class='cython line score-0'>&#xA0;125: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+126:                     <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">/</span> <span class="mf">2.0</span></pre>
<pre class='cython code score-0'>          __pyx_v_c = (__pyx_v_a + (__pyx_v_b / 2.0));
        }
        __pyx_L13_break:;
</pre><pre class='cython line score-0'>&#xA0;127: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+128:                 <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span></pre>
<pre class='cython code score-2'>        __pyx_t_67 = (__pyx_v_t + 1);
        __pyx_t_65 = -1;
        if (__pyx_t_67 &lt; 0) {
          __pyx_t_67 += __pyx_pybuffernd_S.diminfo[0].shape;
          if (unlikely(__pyx_t_67 &lt; 0)) __pyx_t_65 = 0;
        } else if (unlikely(__pyx_t_67 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_65 = 0;
        if (unlikely(__pyx_t_65 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_65);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_67, __pyx_pybuffernd_S.diminfo[0].strides) = __pyx_v_c;
        goto __pyx_L11;
      }
      __pyx_L11:;
</pre><pre class='cython line score-0'>&#xA0;129: </pre>
<pre class='cython line score-50' onclick='toggleDiv(this)'>+130:             <span class="k">assert</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]),</span> <span class="s">&#39;NaN-value calculated for soil state&#39;</span></pre>
<pre class='cython code score-50'>      #ifndef CYTHON_WITHOUT_ASSERTIONS
      if (unlikely(!Py_OptimizeFlag)) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_68 = (__pyx_v_t + 1);
        __pyx_t_65 = -1;
        if (__pyx_t_68 &lt; 0) {
          __pyx_t_68 += __pyx_pybuffernd_S.diminfo[0].shape;
          if (unlikely(__pyx_t_68 &lt; 0)) __pyx_t_65 = 0;
        } else if (unlikely(__pyx_t_68 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_65 = 0;
        if (unlikely(__pyx_t_65 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_65);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_68, __pyx_pybuffernd_S.diminfo[0].strides)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_4 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          }
        }
        if (!__pyx_t_4) {
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        } else {
          __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          __pyx_t_2 = 0;
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Invert</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_47 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_47 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_47)) {
          <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_kp_s_NaN_value_calculated_for_soil_st);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
      }
      #endif
      goto __pyx_L5;
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;131: </pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+132:         <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_min</span><span class="p">(</span><span class="n">S_cap</span><span class="p">,</span> <span class="n">c_max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mf">1</span><span class="p">]))</span> <span class="c">#Make sure the solution is larger then 0.0 and smaller than S_cap</span></pre>
<pre class='cython code score-4'>    __pyx_t_69 = (__pyx_v_t + 1);
    __pyx_t_65 = -1;
    if (__pyx_t_69 &lt; 0) {
      __pyx_t_69 += __pyx_pybuffernd_S.diminfo[0].shape;
      if (unlikely(__pyx_t_69 &lt; 0)) __pyx_t_65 = 0;
    } else if (unlikely(__pyx_t_69 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_65 = 0;
    if (unlikely(__pyx_t_65 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_65);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_70 = (__pyx_v_t + 1);
    __pyx_t_65 = -1;
    if (__pyx_t_70 &lt; 0) {
      __pyx_t_70 += __pyx_pybuffernd_S.diminfo[0].shape;
      if (unlikely(__pyx_t_70 &lt; 0)) __pyx_t_65 = 0;
    } else if (unlikely(__pyx_t_70 &gt;= __pyx_pybuffernd_S.diminfo[0].shape)) __pyx_t_65 = 0;
    if (unlikely(__pyx_t_65 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_65);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_70, __pyx_pybuffernd_S.diminfo[0].strides) = __pyx_f_5GWTSA_10unsat_zone_c_min(__pyx_v_S_cap, __pyx_f_5GWTSA_10unsat_zone_c_max(0.0, (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float_t *, __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.buf, __pyx_t_69, __pyx_pybuffernd_S.diminfo[0].strides))));
  }
</pre><pre class='cython line score-0'>&#xA0;133: </pre>
<pre class='cython line score-87' onclick='toggleDiv(this)'>+134:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">np</span>.<span class="kt">float_t</span>] <span class="nf">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">K_sat</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="mf">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">S</span><span class="p">[:</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="mf">1</span><span class="p">:])</span> <span class="o">/</span> <span class="n">S_cap</span><span class="p">)</span> <span class="o">**</span> <span class="n">Beta</span> <span class="p">)</span></pre>
<pre class='cython code score-87'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_append);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_K_sat * __pyx_v_dt) / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(((PyObject *)__pyx_v_S), 0, -1, NULL, NULL, &amp;__pyx_slice_, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_slice_ = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(((PyObject *)__pyx_v_S), 1, 0, NULL, NULL, &amp;__pyx_slice__2, 1, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_71 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_71)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_71);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_S_cap);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_71, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_71); __pyx_t_71 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_Beta);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_71 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_2, __pyx_t_4, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_71)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_71);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_71);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_71); __pyx_t_71 = 0;
  __pyx_t_71 = NULL;
  __pyx_t_1 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_71 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_71)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_71);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_1 = 1;
    }
  }
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (__pyx_t_71) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_71); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_71); __pyx_t_71 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_1, __pyx_float_0_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_72 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_R.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_72, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_R = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_R.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_R.diminfo[0].strides = __pyx_pybuffernd_R.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_R.diminfo[0].shape = __pyx_pybuffernd_R.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_72 = 0;
  __pyx_v_R = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_slice__2 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
</pre><pre class='cython line score-0'>&#xA0;135: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+136:     <span class="k">return</span> <span class="n">R</span><span class="p">,</span> <span class="n">S</span></pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_R));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)__pyx_v_R));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_R));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_S));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, ((PyObject *)__pyx_v_S));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_S));
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre></div></body></html>
